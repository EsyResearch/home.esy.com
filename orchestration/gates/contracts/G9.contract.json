{
  "gate": "G9",
  "name": "Publication Approval",
  "blocking": true,
  "description": "Validates director sign-off, visualEssays.ts updated, ArtifactDetailWrapper verified, and deployment readiness. Approval document must not contain rejection.",
  "required_outputs": {
    "any_of": [
      {
        "path": "{artifact_path}/research/PUBLICATION-APPROVAL.md",
        "description": "Director sign-off approval document"
      },
      {
        "path": "{artifact_path}/PUBLICATION-APPROVAL.md",
        "description": "Director sign-off approval document (essay root level)"
      }
    ]
  },
  "validations": [
    {
      "type": "file_exists",
      "target": "any_of",
      "description": "Publication approval document must exist"
    },
    {
      "type": "not_contains",
      "target": "{artifact_path}/research/PUBLICATION-APPROVAL.md",
      "pattern": "REJECTED",
      "severity": "error",
      "description": "Publication approval must not contain REJECTED"
    },
    {
      "type": "not_contains",
      "target": "{artifact_path}/research/PUBLICATION-APPROVAL.md",
      "pattern": "status: FAIL",
      "severity": "error",
      "description": "Publication approval must not have FAIL status in frontmatter"
    },
    {
      "type": "contains_text",
      "target": "{artifact_path}/page.tsx",
      "patterns": [
        "ArtifactDetailWrapper"
      ],
      "severity": "error",
      "description": "Final verification: page.tsx MUST use ArtifactDetailWrapper at publication time (visual-essay-engineering-standard.md Â§Red Lines)"
    },
    {
      "type": "frontmatter_status",
      "target": "{artifact_path}/research/PUBLICATION-APPROVAL.md",
      "checks": {
        "status": {
          "not": "FAIL"
        }
      },
      "severity": "error",
      "description": "Frontmatter status must not be FAIL (parsed from YAML)"
    }
  ],
  "notes": "G9 is the final human gate. The director reviews the complete package (all prior gates passed), confirms visualEssays.ts is updated with the new entry (isNew: true, isFeatured: true), verifies ArtifactDetailWrapper is in page.tsx, and triggers deployment. This gate is always manually approved. The contains_text check for ArtifactDetailWrapper provides a final safety net. The not_contains and frontmatter_status checks ensure rejected approvals don't pass."
}
