/* ============================================
   THE BLUES: AMERICA'S HAUNTED FOUNDATION
   Visual Essay Stylesheet
   Derived from DESIGN-RESEARCH.md
   ============================================ */

/* --- CSS Custom Properties --- */
:root {
  /* Primary Colors - Derived from Blues Material Culture */
  --blues-ink-black: #0A0A0A;      /* Night in a juke joint */
  --blues-weathered-wood: #1A1817; /* Aged cypress, tobacco-stained walls */
  --blues-tobacco-brown: #4A3728;  /* Worn leather, aged paper */
  --blues-midnight: #1E3A5F;       /* The name itself - blue */
  --blues-rust-red: #8B2323;       /* Delta clay, dried blood */
  --blues-parchment: #F5F0E6;      /* Cotton paper, aged documents */

  /* Era Colors */
  --era-pre-recording: #E8E0D0;    /* Sepia - before the microphone */
  --era-classic-gold: #C9A66B;     /* Gold/amber - stage lights, sequins */
  --era-depression-gray: #808080;  /* Gray - hard times */
  --era-chicago-electric: #4169E1; /* Electric blue - neon, amplification */
  --era-revival-purple: #9370DB;   /* Purple - psychedelic, Hendrix era */

  /* Accent Colors - Juke Joint Neon */
  --accent-neon-red: #FF4136;
  --accent-neon-blue: #0074D9;
  --accent-paramount-gold: #D4A94D;

  /* Text Opacity */
  --text-primary: 0.95;
  --text-secondary: 0.65;
  --text-tertiary: 0.45;

  /* Animation Timing - Based on Blues Rhythms */
  --ease-blues: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-dramatic: cubic-bezier(0.16, 1, 0.3, 1);
  --duration-bent-note: 400ms;
  --duration-crossfade: 500ms;
  --stagger-shuffle: 75ms;
  --spin-78rpm: 770ms;

  /* Grain Levels for Era Processing */
  --grain-heavy: 0.5;
  --grain-moderate: 0.25;
  --grain-documentary: 0.3;
  --grain-light: 0.15;

  /* Typography */
  --font-headline: 'Clarendon', 'Rockwell', 'Courier Prime', Georgia, serif;
  --font-body: 'Georgia', 'Lora', 'Literata', serif;
  --font-quote: 'Playfair Display', 'Georgia', serif;
  --font-archive: 'Courier New', 'IBM Plex Mono', monospace;

  /* Spacing */
  --spacing-xs: 0.5rem;
  --spacing-sm: 1rem;
  --spacing-md: 2rem;
  --spacing-lg: 4rem;
  --spacing-xl: 8rem;
}

/* --- Base Styles --- */
.blues-essay {
  background-color: var(--blues-ink-black);
  color: var(--blues-parchment);
  font-family: var(--font-body);
  font-size: 18px;
  line-height: 1.7;
  letter-spacing: 0.01em;
  min-height: 100vh;
  overflow-x: hidden;
}

.blues-essay * {
  box-sizing: border-box;
}

/* --- Typography --- */
.blues-essay h1,
.blues-essay h2,
.blues-essay h3 {
  font-family: var(--font-headline);
  font-weight: 700;
  letter-spacing: 0.02em;
}

.blues-essay h1 {
  font-size: clamp(2.5rem, 8vw, 5rem);
  line-height: 1.1;
  text-transform: uppercase;
}

.blues-essay h2 {
  font-size: clamp(1.75rem, 5vw, 3rem);
  line-height: 1.2;
  margin-bottom: var(--spacing-md);
}

.blues-essay h3 {
  font-size: clamp(1.25rem, 3vw, 1.75rem);
  line-height: 1.3;
  color: var(--era-classic-gold);
}

.blues-essay p {
  margin-bottom: 1.5em;
  opacity: var(--text-primary);
}

/* Quotes - Italic Serif, Lyrical */
.blues-essay blockquote {
  font-family: var(--font-quote);
  font-style: italic;
  font-size: 1.25rem;
  line-height: 1.6;
  padding: var(--spacing-md) var(--spacing-lg);
  margin: var(--spacing-lg) 0;
  background: rgba(74, 55, 40, 0.15);
}

.blues-essay blockquote cite {
  display: block;
  margin-top: var(--spacing-sm);
  font-style: normal;
  font-family: var(--font-archive);
  font-size: 0.875rem;
  opacity: var(--text-secondary);
}

/* Archive/Technical Text */
.blues-essay .archive-text {
  font-family: var(--font-archive);
  font-size: 0.875rem;
  opacity: var(--text-tertiary);
}

.blues-essay .date-marker {
  font-family: var(--font-archive);
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--era-classic-gold);
}

/* --- Hero Section --- */
.blues-hero {
  position: relative;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  overflow: hidden;
}

.blues-hero__image-container {
  position: absolute;
  inset: 0;
  z-index: 0;
}

.blues-hero__image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center 30%;
  filter: grayscale(0.4) contrast(1.1) sepia(0.3);
}

.blues-hero__overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    rgba(10, 10, 10, 0.5) 0%,
    rgba(10, 10, 10, 0.7) 40%,
    rgba(10, 10, 10, 0.85) 100%
  );
}

.blues-hero__content {
  position: relative;
  z-index: 1;
  padding: var(--spacing-xl) var(--spacing-md);
}

.blues-hero__title {
  font-size: clamp(3rem, 12vw, 8rem);
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--spacing-sm);
  background: linear-gradient(
    135deg,
    var(--blues-parchment) 0%,
    var(--era-classic-gold) 50%,
    var(--blues-parchment) 100%
  );
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
}

.blues-hero__subtitle {
  font-family: var(--font-quote);
  font-style: italic;
  font-size: clamp(1rem, 3vw, 1.5rem);
  opacity: var(--text-secondary);
  max-width: 600px;
}

.blues-hero__context {
  font-family: var(--font-archive);
  font-size: 0.875rem;
  margin-top: var(--spacing-lg);
  opacity: var(--text-tertiary);
}

.blues-hero__context:first-child {
  margin-top: 0;
  margin-bottom: var(--spacing-md);
}

/* --- Chapter Sections --- */
.blues-chapter {
  position: relative;
  padding: var(--spacing-xl) var(--spacing-md);
  max-width: 900px;
  margin: 0 auto;
}

.blues-chapter__number {
  font-family: var(--font-archive);
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  color: var(--blues-midnight);
  margin-bottom: var(--spacing-sm);
}

.blues-chapter__title {
  margin-bottom: var(--spacing-sm);
}

.blues-chapter__subtitle {
  font-family: var(--font-quote);
  font-style: italic;
  font-size: 1.125rem;
  opacity: var(--text-secondary);
  margin-bottom: var(--spacing-lg);
}

.blues-chapter__content {
  opacity: var(--text-primary);
}

/* --- Era-Specific Styling --- */
.era-pre-recording {
  --current-era-color: var(--era-pre-recording);
}

.era-classic {
  --current-era-color: var(--era-classic-gold);
}

.era-depression {
  --current-era-color: var(--era-depression-gray);
}

.era-chicago {
  --current-era-color: var(--era-chicago-electric);
}

.era-revival {
  --current-era-color: var(--era-revival-purple);
}

/* Era border removed - not in spec */

/* --- Figure Profiles --- */
.blues-figure {
  background: rgba(26, 24, 23, 0.6);
  padding: var(--spacing-md);
  margin: var(--spacing-lg) 0;
  overflow: hidden; /* clearfix for floated image */
}

.blues-figure__name {
  font-family: var(--font-headline);
  font-size: 1.5rem;
  color: var(--blues-parchment);
  margin-bottom: var(--spacing-xs);
}

.blues-figure__title {
  font-family: var(--font-quote);
  font-style: italic;
  font-size: 1rem;
  color: var(--era-classic-gold);
  margin-bottom: var(--spacing-sm);
}

.blues-figure__dates {
  font-family: var(--font-archive);
  font-size: 0.75rem;
  opacity: var(--text-tertiary);
  margin-bottom: var(--spacing-sm);
}

.blues-figure__bio {
  font-size: 0.95rem;
  line-height: 1.6;
}

.blues-figure__image {
  width: 150px;
  height: auto;
  border-radius: 2px;
  margin-bottom: var(--spacing-sm);
  filter: sepia(0.2) contrast(1.1);
  float: left;
  margin-right: var(--spacing-md);
}

/* --- Image Treatments by Era --- */
.blues-image {
  position: relative;
  overflow: hidden;
}

.blues-image::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.blues-image--pre-recording::after {
  background:
    url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity: 0.5;
  mix-blend-mode: overlay;
}

.blues-image--pre-recording img {
  filter: grayscale(1) contrast(1.3);
}

.blues-image--classic::after {
  background: linear-gradient(
    135deg,
    rgba(201, 166, 107, 0.15) 0%,
    transparent 100%
  );
}

.blues-image--classic img {
  filter: sepia(0.4) contrast(1.1) saturate(0.9);
}

.blues-image--depression img {
  filter: grayscale(1) contrast(1.2);
}

.blues-image--chicago img {
  filter: saturate(1.1) contrast(1.05);
}

/* --- Scroll Lock Sections --- */
.blues-scroll-lock {
  position: relative;
  min-height: 300vh;
}

.blues-scroll-lock__sticky {
  position: sticky;
  top: 0;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.blues-scroll-lock__content {
  position: relative;
  width: 100%;
  max-width: 1200px;
  padding: var(--spacing-md);
}

/* --- Timeline Component --- */
.blues-timeline {
  position: relative;
  padding-left: var(--spacing-lg);
  margin: var(--spacing-xl) 0;
}

.blues-timeline::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  background: linear-gradient(
    to bottom,
    var(--era-pre-recording),
    var(--era-classic-gold),
    var(--era-depression-gray),
    var(--era-chicago-electric),
    var(--era-revival-purple)
  );
}

.blues-timeline__item {
  position: relative;
  padding-bottom: var(--spacing-md);
}

.blues-timeline__item::before {
  content: '';
  position: absolute;
  left: calc(-1 * var(--spacing-lg) - 4px);
  top: 0.5em;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--era-classic-gold);
  border: 2px solid var(--blues-ink-black);
}

.blues-timeline__date {
  font-family: var(--font-archive);
  font-size: 0.75rem;
  color: var(--era-classic-gold);
  margin-bottom: var(--spacing-xs);
}

.blues-timeline__event {
  font-size: 0.95rem;
  opacity: var(--text-primary);
}

/* --- Progress Bar (78 RPM Record Metaphor) --- */
.blues-progress {
  position: fixed;
  left: var(--spacing-sm);
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  display: none;
}

@media (min-width: 1200px) {
  .blues-progress {
    display: block;
  }
}

.blues-progress__record {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background:
    radial-gradient(circle at center, var(--blues-ink-black) 20%, transparent 21%),
    repeating-radial-gradient(
      circle at center,
      var(--blues-weathered-wood) 0px,
      var(--blues-weathered-wood) 1px,
      var(--blues-tobacco-brown) 2px,
      var(--blues-tobacco-brown) 3px
    );
  border: 2px solid var(--blues-tobacco-brown);
  position: relative;
}

.blues-progress__needle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 25px;
  height: 2px;
  background: var(--era-classic-gold);
  transform-origin: left center;
  transform: rotate(var(--progress-angle, -45deg));
  transition: transform 0.1s linear;
}

/* --- Animation Keyframes --- */

/* The Bent Note - weighted rise with overshoot */
@keyframes bentNoteReveal {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  60% {
    opacity: 1;
    transform: translateY(-3px);
  }
  100% {
    transform: translateY(0);
  }
}

/* 78 RPM Spin */
@keyframes spin78 {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Fade up - standard reveal */
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Shuffle Stagger Pattern (12/8 blues timing) */
.shuffle-reveal > *:nth-child(3n+1) { animation-delay: 0ms; }
.shuffle-reveal > *:nth-child(3n+2) { animation-delay: 150ms; }
.shuffle-reveal > *:nth-child(3n+3) { animation-delay: 225ms; }

/* --- Utility Classes --- */
.blues-reveal {
  opacity: 0;
  transform: translateY(20px);
  transition:
    opacity var(--duration-bent-note) var(--ease-blues),
    transform var(--duration-bent-note) var(--ease-blues);
}

.blues-reveal.visible {
  opacity: 1;
  transform: translateY(0);
}

.blues-center {
  text-align: center;
}

.blues-wide {
  max-width: 1200px;
  margin: 0 auto;
}

/* --- Sources Section --- */
.blues-sources {
  background: var(--blues-weathered-wood);
  padding: var(--spacing-xl) var(--spacing-md);
  margin-top: var(--spacing-xl);
}

.blues-sources__title {
  font-family: var(--font-headline);
  font-size: 1.5rem;
  margin-bottom: var(--spacing-lg);
  text-align: center;
}

.blues-sources__list {
  max-width: 800px;
  margin: 0 auto;
  list-style: none;
  padding: 0;
}

.blues-sources__item {
  padding: var(--spacing-sm) 0;
  border-bottom: 1px solid rgba(245, 240, 230, 0.1);
  font-size: 0.875rem;
}

.blues-sources__item a {
  color: var(--accent-neon-blue);
  text-decoration: none;
  transition: color 0.2s ease;
}

.blues-sources__item a:hover {
  color: var(--era-classic-gold);
  text-decoration: underline;
}

.blues-sources__tier {
  font-family: var(--font-archive);
  font-size: 0.625rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  padding: 2px 6px;
  border-radius: 2px;
  margin-right: var(--spacing-xs);
}

.blues-sources__tier--1 {
  background: var(--era-classic-gold);
  color: var(--blues-ink-black);
}

.blues-sources__tier--2 {
  background: var(--blues-midnight);
  color: var(--blues-parchment);
}

/* --- 78 RPM Record Progress Bar --- */
.blues-progress {
  position: fixed;
  z-index: 100;
}

.blues-progress--desktop {
  left: var(--spacing-md);
  top: 50%;
  transform: translateY(-50%);
  display: none;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-md);
}

@media (min-width: 1200px) {
  .blues-progress--desktop {
    display: flex;
  }
}

.blues-progress__record {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: var(--blues-weathered-wood);
  position: relative;
  box-shadow:
    0 0 0 2px var(--blues-tobacco-brown),
    0 4px 12px rgba(0, 0, 0, 0.4);
}

.blues-progress__grooves {
  position: absolute;
  inset: 8px;
  border-radius: 50%;
  background: repeating-radial-gradient(
    circle at center,
    var(--blues-ink-black) 0px,
    var(--blues-ink-black) 1px,
    var(--blues-tobacco-brown) 1px,
    var(--blues-tobacco-brown) 2px
  );
}

.blues-progress__grooves::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--blues-ink-black);
}

.blues-progress__label {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 26px;
  height: 26px;
  border-radius: 50%;
  background: var(--era-classic-gold);
  display: flex;
  align-items: center;
  justify-content: center;
}

.blues-progress__label-text {
  font-family: var(--font-archive);
  font-size: 5px;
  font-weight: bold;
  color: var(--blues-ink-black);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.blues-progress__needle {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 28px;
  height: 3px;
  background: linear-gradient(
    to right,
    transparent 0%,
    var(--era-classic-gold) 30%,
    var(--blues-parchment) 100%
  );
  transform-origin: left center;
  transition: transform 0.15s ease-out;
  border-radius: 0 2px 2px 0;
}

.blues-progress__needle::after {
  content: '';
  position: absolute;
  right: -2px;
  top: 50%;
  transform: translateY(-50%);
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--blues-parchment);
  box-shadow: 0 0 4px var(--era-classic-gold);
}

.blues-progress__tracks {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.blues-progress__track {
  font-family: var(--font-archive);
  font-size: 9px;
  color: var(--blues-parchment);
  opacity: 0.3;
  padding: 2px 6px;
  border-radius: 2px;
  transition: opacity 0.2s ease, background 0.2s ease;
  cursor: default;
}

.blues-progress__track--active {
  opacity: 0.6;
}

.blues-progress__track--current {
  opacity: 1;
  background: rgba(201, 166, 107, 0.2);
  color: var(--era-classic-gold);
}

.blues-progress__track-num {
  display: block;
  text-align: center;
}

/* Mobile Progress Bar */
.blues-progress--mobile {
  bottom: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: rgba(245, 240, 230, 0.1);
  display: block;
}

.blues-progress--mobile .blues-progress__fill {
  height: 100%;
  background: linear-gradient(
    to right,
    var(--blues-midnight),
    var(--era-classic-gold)
  );
  transition: width 0.1s linear;
}

@media (min-width: 1200px) {
  .blues-progress--mobile {
    display: none;
  }
}

/* --- Content Warning --- */
.blues-content-warning {
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-sm);
  padding: var(--spacing-sm) var(--spacing-md);
  margin-bottom: var(--spacing-md);
  background: rgba(139, 35, 35, 0.15);
  border-left: 3px solid var(--blues-rust-red);
  border-radius: 0 4px 4px 0;
  font-size: 0.875rem;
}

.blues-content-warning--global {
  position: fixed;
  top: var(--spacing-md);
  left: 50%;
  transform: translateX(-50%);
  max-width: 600px;
  z-index: 90;
  background: rgba(10, 10, 10, 0.95);
  border: 1px solid var(--blues-rust-red);
  border-left-width: 3px;
  border-radius: 4px;
  animation: warning-fade-in 0.5s ease forwards;
}

@keyframes warning-fade-in {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

.blues-content-warning__icon {
  font-size: 1rem;
  line-height: 1;
  flex-shrink: 0;
}

.blues-content-warning__text {
  margin: 0;
  line-height: 1.5;
  opacity: var(--text-secondary);
}

.blues-content-warning__text strong {
  color: var(--blues-rust-red);
  opacity: 1;
}

.blues-content-warning__dismiss {
  background: none;
  border: none;
  color: var(--blues-parchment);
  opacity: 0.5;
  font-size: 1rem;
  cursor: pointer;
  padding: 0;
  margin-left: auto;
  flex-shrink: 0;
  transition: opacity 0.2s ease;
}

.blues-content-warning__dismiss:hover {
  opacity: 1;
}

/* --- Methodology Note --- */
.blues-methodology {
  max-width: 800px;
  margin: var(--spacing-xl) auto;
  padding: var(--spacing-lg) var(--spacing-md);
  background: rgba(74, 55, 40, 0.2);
}

.blues-methodology__title {
  font-family: var(--font-headline);
  font-size: 1.25rem;
  margin-bottom: var(--spacing-md);
  color: var(--era-classic-gold);
}

.blues-methodology__list {
  margin: var(--spacing-md) 0 0;
  padding-left: var(--spacing-md);
}

.blues-methodology__list li {
  margin-bottom: var(--spacing-sm);
  line-height: 1.6;
  opacity: var(--text-secondary);
}

.blues-methodology__list li strong {
  color: var(--blues-parchment);
  opacity: 1;
}

/* --- Mobile Optimizations --- */
@media (max-width: 768px) {
  .blues-essay {
    font-size: 16px;
  }

  .blues-chapter {
    padding: var(--spacing-lg) var(--spacing-sm);
  }

  .blues-figure {
    padding: var(--spacing-sm);
  }

  .blues-figure__image {
    float: none;
    display: block;
    margin: 0 auto var(--spacing-sm) auto;
    width: 120px;
  }

  .blues-timeline {
    padding-left: var(--spacing-md);
  }

  .blues-hero {
    padding: var(--spacing-lg) var(--spacing-sm);
  }
}

/* --- Safe Area Support (Notch, Home Indicator) --- */
@supports (padding-top: env(safe-area-inset-top)) {
  .blues-essay {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .blues-progress--mobile {
    height: calc(3px + env(safe-area-inset-bottom, 0px));
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }

  .blues-content-warning--global {
    top: calc(var(--spacing-md) + env(safe-area-inset-top, 0px));
  }
}

/* --- Reduced Motion --- */
@media (prefers-reduced-motion: reduce) {
  .blues-reveal {
    transition: opacity 0.3s ease;
    transform: none;
  }

  .blues-essay *,
  .blues-essay *::before,
  .blues-essay *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* --- Dark Mode (default for this essay) --- */
@media (prefers-color-scheme: light) {
  /* This essay is intentionally dark - no light mode override */
}
