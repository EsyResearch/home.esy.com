[build]
  command = "npm run build:static"
  publish = "out"

[build.environment]
  NODE_VERSION = "18"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Redirect scrollytelling stories to visual essays (canonical URLs)
# 301 permanent redirect for SEO
[[redirects]]
  from = "/scrollytelling/:slug"
  to = "/essays/visual/:slug"
  status = 301
  force = true

# Proxy /guide section to a separate Netlify site
# This allows the guide to be maintained and deployed independently
# while appearing as part of the main esy.com domain
[[redirects]]
  from = "/guide/*"  # Capture all paths under /guide/
  to = "https://esy-guide.netlify.app/:splat"  # Proxy to guide subdomain, preserving path
  status = 200  # Rewrite (proxy) rather than redirect - URL stays as esy.com/guide/*
  force = true  # Override any existing content at these paths 